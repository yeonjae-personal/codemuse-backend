# ğŸ—ï¸ CodeMuse ì•„í‚¤í…ì²˜íŒ€ ì „ë‹¬ ë¬¸ì„œ

> **ì‘ì„±ì¼**: 2025-10-13  
> **ëŒ€ìƒ**: ì•„í‚¤í…ì²˜íŒ€  
> **ëª©ì **: CodeMuse ë°±ì—”ë“œ ì‹œìŠ¤í…œì˜ ì•„í‚¤í…ì²˜ í˜„í™© ë° ê¸°ìˆ  ìŠ¤íƒ ê³µìœ 

---

## ğŸ“‹ ëª©ì°¨

1. [ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ê°œìš”](#1-ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜-ê°œìš”)
2. [ê¸°ìˆ  ìŠ¤íƒ ë° ì˜ì¡´ì„±](#2-ê¸°ìˆ -ìŠ¤íƒ-ë°-ì˜ì¡´ì„±)
3. [ì„œë¹„ìŠ¤ë³„ ìƒì„¸ ìŠ¤í™](#3-ì„œë¹„ìŠ¤ë³„-ìƒì„¸-ìŠ¤í™)
4. [ì¸í”„ë¼ ë° ë°°í¬](#4-ì¸í”„ë¼-ë°-ë°°í¬)
5. [ë³´ì•ˆ ê³ ë ¤ì‚¬í•­](#5-ë³´ì•ˆ-ê³ ë ¤ì‚¬í•­)
6. [ì„±ëŠ¥ ë° í™•ì¥ì„±](#6-ì„±ëŠ¥-ë°-í™•ì¥ì„±)
7. [ëª¨ë‹ˆí„°ë§ ë° ìš´ì˜](#7-ëª¨ë‹ˆí„°ë§-ë°-ìš´ì˜)
8. [ì•„í‚¤í…ì²˜ ê²°ì • ì‚¬í•­(ADR)](#8-ì•„í‚¤í…ì²˜-ê²°ì •-ì‚¬í•­adr)
9. [ë§ˆì´ê·¸ë ˆì´ì…˜/ë°°í¬ ì „ëµ](#9-ë§ˆì´ê·¸ë ˆì´ì…˜ë°°í¬-ì „ëµ)
10. [ê°œì„  ê¶Œê³ ì‚¬í•­](#10-ê°œì„ -ê¶Œê³ ì‚¬í•­-ìš°ì„ ìˆœìœ„ë³„)
11. [ê¸°ìˆ  ë¶€ì±„ ë° ì œì•½ì‚¬í•­](#11-ê¸°ìˆ -ë¶€ì±„-ë°-ì œì•½ì‚¬í•­)
12. [ì°¸ê³  ë¬¸ì„œ](#12-ì°¸ê³ -ë¬¸ì„œ)

---

## 1. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ê°œìš”

### 1.1 ì „ì²´ êµ¬ì¡°

- **ì•„í‚¤í…ì²˜ íŒ¨í„´**: ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ê¸°ë°˜ ëª¨ë“ˆí˜• ì•„í‚¤í…ì²˜
- **ì„œë¹„ìŠ¤ êµ¬ì„±**: 4ê°œì˜ ë…ë¦½ ì„œë¹„ìŠ¤ + ê³µí†µ ëª¨ë“ˆ
- **í†µì‹  ë°©ì‹**: REST API (í¬íŠ¸ ê¸°ë°˜ ì„œë¹„ìŠ¤ ê²©ë¦¬)
- **ë°ì´í„° íë¦„**: Document Generator â†’ RAG Engine â†’ LLM Chat Service â† Workflow Orchestrator

### 1.2 ì„œë¹„ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Workflow Orchestrator                     â”‚
â”‚                    (í¬íŠ¸: 8006)                              â”‚
â”‚        - ì„œë¹„ìŠ¤ ê°„ ì¡°ìœ¨ ë° ì›Œí¬í”Œë¡œìš° ê´€ë¦¬                    â”‚
â”‚        - SSE ìŠ¤íŠ¸ë¦¬ë° ì¡°ìœ¨                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚            â”‚             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Document        â”‚  â”‚ RAG       â”‚  â”‚ LLM Chat         â”‚
    â”‚ Generator       â”‚  â”‚ Engine    â”‚  â”‚ Service          â”‚
    â”‚ (í¬íŠ¸: 8001)    â”‚  â”‚(í¬íŠ¸:8003)â”‚  â”‚ (í¬íŠ¸: 8004)     â”‚
    â”‚                 â”‚  â”‚           â”‚  â”‚                  â”‚
    â”‚ - AST íŒŒì‹±      â”‚  â”‚ - ë²¡í„° DB â”‚  â”‚ - OpenAI ì—°ë™    â”‚
    â”‚ - MD ìƒì„±       â”‚  â”‚ - í•˜ì´ë¸Œ  â”‚  â”‚ - ì„¸ì…˜ ê´€ë¦¬      â”‚
    â”‚ - ì²­í¬ ë¶„í•      â”‚  â”‚   ë¦¬ë“œ    â”‚  â”‚ - ì»¨í…ìŠ¤íŠ¸       â”‚
    â”‚                 â”‚  â”‚   ê²€ìƒ‰    â”‚  â”‚   ê¸°ë°˜ ì‘ë‹µ      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.3 í•µì‹¬ ì„œë¹„ìŠ¤ë³„ ì±…ì„

| ì„œë¹„ìŠ¤ | í¬íŠ¸ | í•µì‹¬ ì±…ì„ | ê¸°ìˆ  ìŠ¤íƒ |
|--------|------|-----------|----------|
| Document Generator | 8001 | AST íŒŒì‹±, MD ë¬¸ì„œ ìƒì„± | Python, Jinja2, AST |
| RAG Engine | 8003 | ë²¡í„° ê²€ìƒ‰, í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ | ChromaDB, BM25, OpenAI |
| LLM Chat Service | 8004 | LLM ì—°ë™, ì„¸ì…˜ ê´€ë¦¬ | OpenAI API, Redis |
| Workflow Orchestrator | 8006 | ì„œë¹„ìŠ¤ ì¡°ìœ¨, ì›Œí¬í”Œë¡œìš° | AsyncIO, SSE |

---

## 2. ê¸°ìˆ  ìŠ¤íƒ ë° ì˜ì¡´ì„±

### 2.1 ë°±ì—”ë“œ í”„ë ˆì„ì›Œí¬

- **ì–¸ì–´**: Python 3.11+
- **ì›¹ í”„ë ˆì„ì›Œí¬**: FastAPI (ë¹„ë™ê¸° ì²˜ë¦¬ ì§€ì›)
- **ë¹„ë™ê¸° ì²˜ë¦¬**: asyncio, aiohttp

### 2.2 ë°ì´í„° ì €ì¥ì†Œ

```yaml
PostgreSQL:
  ìš©ë„: ì„¸ì…˜, ë©”íƒ€ë°ì´í„°
  í¬íŠ¸: 5432
  ë²„ì „: 15
  
Redis:
  ìš©ë„: ìºì‹±, ì„¸ì…˜ ìŠ¤í† ì–´
  í¬íŠ¸: 6379
  ë²„ì „: 7-alpine
  
ChromaDB:
  ìš©ë„: ë²¡í„° ì„ë² ë”© ì €ì¥
  ëª¨ë“œ: ë¡œì»¬ í¼ì‹œìŠ¤í„´íŠ¸
  ìœ„ì¹˜: rag_storage/chroma_db
  ì„ë² ë”© ëª¨ë¸: text-embedding-3-small
  ì°¨ì›: 1536
```

### 2.3 ì™¸ë¶€ API

| API | ìš©ë„ | ëª¨ë¸ |
|-----|------|------|
| OpenAI API | LLM ì‘ë‹µ ìƒì„± | GPT-3.5-turbo, GPT-4 |
| OpenAI Embeddings | ë²¡í„° ì„ë² ë”© ìƒì„± | text-embedding-3-small |
| Anthropic API | LLM ì‘ë‹µ ìƒì„± (ì˜µì…˜) | Claude |

### 2.4 ì£¼ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬

```python
# ì›¹ í”„ë ˆì„ì›Œí¬
fastapi==0.104.1
uvicorn[standard]==0.24.0
pydantic==2.5.0

# ë°ì´í„°ë² ì´ìŠ¤
sqlalchemy==2.0.23
alembic==1.13.1
psycopg2-binary==2.9.9
redis==5.0.1

# LLM ë° AI
openai==1.3.7
anthropic==0.7.8
langchain==0.0.350
chromadb==0.4.18

# ë²¡í„° ê²€ìƒ‰
numpy==1.24.3
scikit-learn==1.3.2
rank-bm25  # í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰

# í…œí”Œë¦¿ ì—”ì§„
jinja2==3.1.2

# ë¹„ë™ê¸° ì²˜ë¦¬
celery==5.3.4
asyncio==3.4.3
httpx==0.25.2
aiofiles==23.2.1

# ê°œë°œ ë„êµ¬
pytest==7.4.3
black==23.11.0
flake8==6.1.0
mypy==1.7.1
```

---

## 3. ì„œë¹„ìŠ¤ë³„ ìƒì„¸ ìŠ¤í™

### 3.1 Document Generator (í¬íŠ¸: 8001)

#### í•µì‹¬ ì±…ì„
- Python ì†ŒìŠ¤ì½”ë“œ AST íŒŒì‹±
- Semantic chunk ìƒì„± (í‰ê·  462ê°œ/í”„ë¡œì íŠ¸)
- Markdown ë¬¸ì„œ ìë™ ìƒì„±
- RAG Engineìœ¼ë¡œ ìë™ ì—…ë¡œë“œ

#### ê¸°ìˆ ì  íŠ¹ì§•
- **í…œí”Œë¦¿ ì‹œìŠ¤í…œ**: Jinja2 ê¸°ë°˜ ì™¸ë¶€ í…œí”Œë¦¿
  - ìœ„ì¹˜: `src/chunker_document_generator/core/templates/`
  - ì–¸ì–´ë³„ í…œí”Œë¦¿: Python, JavaScript, Vue, Java ë“±
- **ë³µì¡ë„ ë¶„ì„**: McCabe Complexity ìë™ ê³„ì‚°
- **ë©”íƒ€ë°ì´í„° ì¶”ì¶œ**: ì˜ì¡´ì„±, íƒœê·¸, ë¼ì¸ ë²”ìœ„, í† í° ìˆ˜
- **í´ë°± ì‹œìŠ¤í…œ**: í…œí”Œë¦¿ ì‹¤íŒ¨ ì‹œ ê¸°ë³¸ ë°©ì‹ìœ¼ë¡œ ìë™ ì „í™˜

#### ì£¼ìš” API ì—”ë“œí¬ì¸íŠ¸

```http
POST /api/v1/documents/generate
  - ì†ŒìŠ¤ì½”ë“œ ë¶„ì„ ë° ë¬¸ì„œ ìƒì„±

GET /api/v1/documents/{document_id}
  - ìƒì„±ëœ ë¬¸ì„œ ì¡°íšŒ

GET /api/v1/documents
  - ì „ì²´ ë¬¸ì„œ ëª©ë¡

GET /health
  - ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
```

#### ìƒì„±ë˜ëŠ” ë¬¸ì„œ êµ¬ì¡°

```
generated_docs/
â”œâ”€â”€ project_overview.md          # í”„ë¡œì íŠ¸ ì „ì²´ ìš”ì•½
â”œâ”€â”€ project_summary.md           # ê³ ìˆ˜ì¤€ ìš”ì•½
â””â”€â”€ [í”„ë¡œì íŠ¸ëª…]/
    â”œâ”€â”€ analyzers/
    â”‚   â”œâ”€â”€ issue_detector.md    # íŒŒì¼ë³„ ë¬¸ì„œ
    â”‚   â””â”€â”€ rule_analyzer.md
    â”œâ”€â”€ formatters/
    â””â”€â”€ streaming/
```

---

### 3.2 RAG Engine (í¬íŠ¸: 8003)

#### í•µì‹¬ ì±…ì„
- MD ë¬¸ì„œ ì„¹ì…˜ ë²¡í„°í™”
- í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ (BM25 + ë²¡í„° ìœ ì‚¬ë„)
- RRF(Reciprocal Rank Fusion) ê¸°ë°˜ ì¬ë­í‚¹
- ì„ë² ë”© ìºì‹± ìµœì í™”

#### ê²€ìƒ‰ ì „ëµ

```python
# 1. ì§ˆì˜ ì „ì²˜ë¦¬
- í•œêµ­ì–´ ì •ê·œí™” (NFC)
- ë³µí•©ëª…ì‚¬ ë¶„í•´
- ë™ì˜ì–´ í™•ì¥ (ì˜¤ë¥˜ â†” ì—ëŸ¬, ì´ìŠˆ / ìœ í˜• â†” íƒ€ì…, ì¢…ë¥˜)

# 2. í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰
- BM25 í‚¤ì›Œë“œ ê²€ìƒ‰ (í•œêµ­ì–´ í† í¬ë‚˜ì´ì§•)
- ë²¡í„° ìœ ì‚¬ë„ ê²€ìƒ‰ (OpenAI ì„ë² ë”©)
- RRFë¡œ ê²°ê³¼ í†µí•©

# 3. ì¬ë­í‚¹
- í´ë” ìš°ì„ ìˆœìœ„ ì ìš© (analyzers > formatters > streaming)
- ì—´ê±° íŒ¨í„´ ë³´ë„ˆìŠ¤
- í‚¤ì›Œë“œ ë§¤ì¹­ ë³´ë„ˆìŠ¤
- ì˜ë¯¸ìŒ ë³´ë„ˆìŠ¤
```

#### í´ë” ìš°ì„ ìˆœìœ„

| í´ë” | ìš°ì„ ìˆœìœ„ | ì„¤ëª… |
|------|---------|------|
| analyzers | 100 | í•µì‹¬ ë¶„ì„ê¸° (ìµœìš°ì„ ) |
| shared | 80 | ê³µìœ  ëª¨ë“ˆ |
| streaming | 60 | ìŠ¤íŠ¸ë¦¬ë° ëª¨ë“ˆ |
| formatters | 40 | í¬ë§¤í„° ëª¨ë“ˆ |
| config | 50 | ì„¤ì • |
| utils | 30 | ìœ í‹¸ë¦¬í‹° |
| templates | 20 | í…œí”Œë¦¿ (ë‚®ì€ ìš°ì„ ìˆœìœ„) |

#### ì£¼ìš” API ì—”ë“œí¬ì¸íŠ¸

```http
POST /api/v1/search
  - í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰
  - íŒŒë¼ë¯¸í„°: query, limit, chunk_type_filter, file_filter

POST /api/v1/documents
  - ë‹¨ì¼ ë¬¸ì„œ ì—…ë¡œë“œ

POST /api/v1/documents/batch
  - ë°°ì¹˜ ë¬¸ì„œ ì—…ë¡œë“œ (ìµœì í™”)

DELETE /api/v1/documents
  - ëª¨ë“  ë¬¸ì„œ ì‚­ì œ

GET /api/v1/documents/folders
  - í´ë” êµ¬ì¡° ì¡°íšŒ

GET /api/v1/cache/stats
  - ìºì‹œ í†µê³„ ì¡°íšŒ

POST /api/v1/cache/clear
  - ìºì‹œ ì´ˆê¸°í™”

GET /health
  - ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
```

#### ì„±ëŠ¥ ìµœì í™”

```python
# ì„ë² ë”© ìºì‹±
- ë©”ëª¨ë¦¬ ê¸°ë°˜ í•´ì‹œ ìºì‹œ
- íˆíŠ¸ìœ¨ ì¶”ì 
- ë°°ì¹˜ ì²˜ë¦¬ (ìµœëŒ€ 100ê°œ/ë°°ì¹˜)
- ìºì‹œ í†µê³„ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§

# BM25 ì¸ë±ìŠ¤
- ë©”ëª¨ë¦¬ ê¸°ë°˜ ì¸ë±ìŠ¤
- í•œêµ­ì–´ í† í¬ë‚˜ì´ì§• ì§€ì›
- ìë™ ì—…ë°ì´íŠ¸ (ë¬¸ì„œ ì¶”ê°€/ì‚­ì œ ì‹œ)
```

---

### 3.3 LLM Chat Service (í¬íŠ¸: 8004)

#### í•µì‹¬ ì±…ì„
- OpenAI API ì—°ë™ ë° í˜¸ì¶œ
- ì„¸ì…˜ ê¸°ë°˜ ëŒ€í™” ê´€ë¦¬
- ì»¨í…ìŠ¤íŠ¸ ê¸°ë°˜ í”„ë¡¬í”„íŠ¸ ìƒì„±
- ì¬ì‹œë„ ë¡œì§ ë° ì—ëŸ¬ í•¸ë“¤ë§

#### í”„ë¡¬í”„íŠ¸ ì „ëµ

```markdown
ì‹œìŠ¤í…œ ë©”ì‹œì§€:
- ì—­í• : "CodeMuse" â€“ ë ˆê±°ì‹œ ì½”ë“œë² ì´ìŠ¤ ë¶„ì„ ì–´ì‹œìŠ¤í„´íŠ¸
- ëª©í‘œ: ì»¨í…ìŠ¤íŠ¸ ê¸°ë°˜ ì‹¤ìš©ì  ë‹µë³€ ìƒì„±

ë‹µë³€ êµ¬ì¡° (3ë‹¨ êµ¬ì„±):
1. í•µì‹¬ ìš”ì§€ (2~4ì¤„ ìš”ì•½)
2. ê·¼ê±° ì„¹ì…˜ ìš”ì•½ (ê´€ë ¨ í•¨ìˆ˜/í´ë˜ìŠ¤/ëª¨ë“ˆ)
3. ì¡°ì¹˜/í™•ì¥ ë°©ë²• (ë‹¨ê³„ì  ì„¤ëª…)

í•„ìˆ˜ ê·œì¹™:
- ìˆ«ì ë³´ì¡´ í•„ìˆ˜ (7ê°€ì§€, 80ë²ˆ ì¤„, 157ë²ˆ ì¤„ ë“±)
- ì¤„ ë²ˆí˜¸ ëª…ì‹œ í•„ìˆ˜
- íŒŒì¼ ê²½ë¡œ ì •í™•íˆ ì œì‹œ
- ë¬¸ë‹¨ êµ¬ë¶„ ëª…í™•íˆ
- ê·¼ê±° ë¶€ì¡± ì‹œ ëª…ì‹œ
```

#### ì—ëŸ¬ í•¸ë“¤ë§

```python
# Exponential Backoff Retry
max_retries = 3
base_delay = 1.0

retry_delays:
  - 1ì°¨ ì‹¤íŒ¨: 1ì´ˆ ëŒ€ê¸°
  - 2ì°¨ ì‹¤íŒ¨: 2ì´ˆ ëŒ€ê¸°
  - 3ì°¨ ì‹¤íŒ¨: 4ì´ˆ ëŒ€ê¸°

# ì¬ì‹œë„ ì¡°ê±´
- 429 ì˜¤ë¥˜ (Rate Limit)ë§Œ ì¬ì‹œë„
- ê¸°íƒ€ ì˜¤ë¥˜ëŠ” ì¦‰ì‹œ ì‹¤íŒ¨ ë°˜í™˜
```

#### API í˜¸ì¶œ í†µê³„

```python
api_call_stats = {
    "total_calls": 0,           # ì´ í˜¸ì¶œ ìˆ˜
    "successful_calls": 0,      # ì„±ê³µ ìˆ˜
    "failed_calls": 0,          # ì‹¤íŒ¨ ìˆ˜
    "calls_per_minute": 0,      # ë¶„ë‹¹ í˜¸ì¶œ ìˆ˜
    "last_call_time": None,     # ë§ˆì§€ë§‰ í˜¸ì¶œ ì‹œê°
    "last_minute_calls": []     # ìµœê·¼ 1ë¶„ í˜¸ì¶œ ëª©ë¡
}
```

#### ì£¼ìš” API ì—”ë“œí¬ì¸íŠ¸

```http
POST /api/v1/chat/sessions
  - ìƒˆ ì±„íŒ… ì„¸ì…˜ ìƒì„±

GET /api/v1/chat/sessions
  - ì„¸ì…˜ ëª©ë¡ ì¡°íšŒ

GET /api/v1/chat/sessions/{session_id}/messages
  - ì„¸ì…˜ ë©”ì‹œì§€ ì¡°íšŒ

POST /api/v1/chat/sessions/{session_id}/messages
  - ë©”ì‹œì§€ ì „ì†¡ (ë™ê¸°)

POST /api/v1/chat/stream
  - ë©”ì‹œì§€ ì „ì†¡ (SSE ìŠ¤íŠ¸ë¦¬ë°)

GET /api/v1/stats
  - API í˜¸ì¶œ í†µê³„ ì¡°íšŒ

GET /api/v1/debug
  - ë””ë²„ê·¸ ì •ë³´ (API í‚¤ ìƒíƒœ ë“±)

GET /health
  - ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
```

---

### 3.4 Workflow Orchestrator (í¬íŠ¸: 8006)

#### í•µì‹¬ ì±…ì„
- ì„œë¹„ìŠ¤ ê°„ í†µì‹  ì¡°ìœ¨
- ì›Œí¬í”Œë¡œìš° ìƒíƒœ ê´€ë¦¬
- SSE ê¸°ë°˜ ì§„í–‰ ìƒí™© ìŠ¤íŠ¸ë¦¬ë°
- í’ˆì§ˆ ê²€í†  ë° ì¬ê²€ìƒ‰

#### ì›Œí¬í”Œë¡œìš° 5ë‹¨ê³„

```
1ë‹¨ê³„: ì§ˆë¬¸ í‘œì¤€í™”
  - ì‚¬ìš©ì ì§ˆë¬¸ ì •ê·œí™”
  - ì˜ë„ íŒŒì•…

2ë‹¨ê³„: LLM í‚¤ì›Œë“œ ì¶”ì¶œ
  - GPTë¥¼ ì´ìš©í•œ ê²€ìƒ‰ í‚¤ì›Œë“œ ìƒì„±
  - í´ë°±: Rule-based í‚¤ì›Œë“œ ì¶”ì¶œ

3ë‹¨ê³„: RAG ê²€ìƒ‰
  - Overview MD ì„¹ì…˜ ê²€ìƒ‰
  - Function MD ì„¹ì…˜ ê²€ìƒ‰
  - ìµœëŒ€ 5ê°œ chunk ì„ ë³„

4ë‹¨ê³„: í’ˆì§ˆ ê²€í† 
  - ê²€ìƒ‰ ê²°ê³¼ í’ˆì§ˆ í‰ê°€
  - í•„ìš” ì‹œ ì¬ê²€ìƒ‰

5ë‹¨ê³„: ìµœì¢… ì‘ë‹µ ìƒì„±
  - ì»¨í…ìŠ¤íŠ¸ + ì§ˆë¬¸ â†’ LLM
  - SSEë¡œ í† í° ìŠ¤íŠ¸ë¦¬ë°
```

#### SSE ì´ë²¤íŠ¸ íƒ€ì…

```javascript
event: status      // ì§„í–‰ ìƒí™© ë©”ì‹œì§€
event: step        // í˜„ì¬ ë‹¨ê³„ ë²ˆí˜¸
event: standardized_question  // í‘œì¤€í™”ëœ ì§ˆë¬¸
event: started     // ì‘ë‹µ ìƒì„± ì‹œì‘
event: model       // ì‚¬ìš© ëª¨ë¸ëª…
event: token       // ì‘ë‹µ í† í° (ì‹¤ì‹œê°„)
event: metrics     // ìµœì¢… ë©”íŠ¸ë¦­ìŠ¤
event: done        // ì™„ë£Œ (ok/error)
```

#### ì£¼ìš” API ì—”ë“œí¬ì¸íŠ¸

```http
POST /workflow/stream
  - SSE ìŠ¤íŠ¸ë¦¬ë° ì›Œí¬í”Œë¡œìš° ì‹¤í–‰

GET /services/status
  - ì—°ê²°ëœ ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸

GET /health
  - ì›Œí¬í”Œë¡œìš° ì„œë¹„ìŠ¤ ìƒíƒœ
```

#### ì„œë¹„ìŠ¤ ê°„ í†µì‹ 

```python
# í™˜ê²½ ë³€ìˆ˜ ê¸°ë°˜ ì„œë¹„ìŠ¤ URL
LLM_SERVICE_URL = os.getenv("LLM_SERVICE_URL", "http://localhost:8004")
RAG_SERVICE_URL = os.getenv("RAG_SERVICE_URL", "http://localhost:8003")

# Docker Compose ë„¤íŠ¸ì›Œí¬ì—ì„œëŠ”
LLM_SERVICE_URL = "http://llm-chat:8004"
RAG_SERVICE_URL = "http://rag-engine:8003"
```

---

## 4. ì¸í”„ë¼ ë° ë°°í¬

### 4.1 Docker Compose êµ¬ì„±

```yaml
# docker-compose.yml
services:
  postgres:
    image: postgres:15
    ports: ["5432:5432"]
    
  redis:
    image: redis:7-alpine
    ports: ["6379:6379"]
    
  document-generator:
    build: ./docker/services/DocumentGenerator.Dockerfile
    ports: ["8001:8001"]
    depends_on: [postgres, redis]
    
  rag-engine:
    build: ./docker/services/RAGEngine.Dockerfile
    ports: ["8003:8003"]
    depends_on: [postgres, redis]
    
  llm-chat:
    build: ./docker/services/LLMChat.Dockerfile
    ports: ["8004:8004"]
    depends_on: [postgres, redis]
    
  workflow-orchestrator:
    build: ./docker/services/WorkflowOrchestrator.Dockerfile
    ports: ["8006:8006"]
    depends_on: [document-generator, rag-engine, llm-chat]
    
  nginx:
    image: nginx:alpine
    ports: ["80:80", "443:443"]
    depends_on: [document-generator, rag-engine, llm-chat, workflow-orchestrator]
```

### 4.2 ë³¼ë¥¨ ê´€ë¦¬

```yaml
volumes:
  postgres_data:
    # PostgreSQL ë°ì´í„° ì˜êµ¬ ì €ì¥
    
  redis_data:
    # Redis ë°ì´í„° ì˜êµ¬ ì €ì¥
    
  ./src:/app/src:
    # ê°œë°œ ì‹œ ì†ŒìŠ¤ì½”ë“œ ì‹¤ì‹œê°„ ë°˜ì˜
    
  ./sample_code:/app/sample_code:
    # ë¶„ì„ ëŒ€ìƒ ì½”ë“œ
    
  ./rag_storage:/app/rag_storage:
    # ChromaDB í¼ì‹œìŠ¤í„´íŠ¸ ì €ì¥ì†Œ
```

### 4.3 í—¬ìŠ¤ì²´í¬ ì„¤ì •

```yaml
healthcheck:
  test: ["CMD", "curl", "-f", "http://localhost:8001/health"]
  interval: 30s      # 30ì´ˆë§ˆë‹¤ ì²´í¬
  timeout: 10s       # 10ì´ˆ íƒ€ì„ì•„ì›ƒ
  retries: 3         # 3íšŒ ì‹¤íŒ¨ ì‹œ unhealthy
```

### 4.4 ë„¤íŠ¸ì›Œí¬ êµ¬ì„±

```
ì™¸ë¶€ â†’ Nginx (80/443) â†’ ë‚´ë¶€ ì„œë¹„ìŠ¤ë“¤
                         â”œâ”€ Document Generator:8001
                         â”œâ”€ RAG Engine:8003
                         â”œâ”€ LLM Chat:8004
                         â””â”€ Workflow:8006
```

---

## 5. ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### 5.1 API í‚¤ ê´€ë¦¬

#### í™˜ê²½ ë³€ìˆ˜ í•„ìˆ˜

```bash
# .env íŒŒì¼
OPENAI_API_KEY=sk-proj-...
ANTHROPIC_API_KEY=sk-ant-...
DATABASE_URL=postgresql://user:pass@localhost:5432/codemuse
SECRET_KEY=your-secret-key-here
```

#### âš ï¸ ë³´ì•ˆ ì´ìŠˆ ë°œê²¬

**ìœ„ì¹˜**: `src/llm_chat_service/app.py`

```python
# 43ë²ˆ ì¤„, 399ë²ˆ ì¤„
correct_api_key = "sk-proj-rtIOr0IHt3Z4CUHy..."  # âŒ í•˜ë“œì½”ë”©
```

**ê¶Œê³ ì‚¬í•­**:
- âœ… ì¦‰ì‹œ í™˜ê²½ ë³€ìˆ˜ë¡œ ì´ê´€
- âœ… Git íˆìŠ¤í† ë¦¬ì—ì„œ ì œê±°
- âœ… OpenAI API í‚¤ ì¬ë°œê¸‰ ê¶Œì¥

### 5.2 CORS ì„¤ì •

#### í˜„ì¬ (ê°œë°œ í™˜ê²½)

```python
app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],  # âš ï¸ ëª¨ë“  origin í—ˆìš©
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)
```

#### í”„ë¡œë•ì…˜ ê¶Œì¥

```python
app.add_middleware(
    CORSMiddleware,
    allow_origins=[
        "https://codemuse.yourdomain.com",
        "https://app.yourdomain.com"
    ],
    allow_credentials=True,
    allow_methods=["GET", "POST", "PUT", "DELETE"],
    allow_headers=["Content-Type", "Authorization"],
)
```

### 5.3 Rate Limiting

#### í˜„ì¬ ìƒíƒœ
- OpenAI API ë ˆë²¨ì—ì„œë§Œ ê´€ë¦¬
- ì‚¬ìš©ìë³„/IPë³„ ì œí•œ ì—†ìŒ

#### ê¶Œê³ ì‚¬í•­

```python
from slowapi import Limiter
from slowapi.util import get_remote_address

limiter = Limiter(key_func=get_remote_address)
app.state.limiter = limiter

@app.post("/api/v1/chat/sessions/{session_id}/messages")
@limiter.limit("10/minute")  # ë¶„ë‹¹ 10íšŒ ì œí•œ
async def send_message(...):
    ...
```

### 5.4 ë°ì´í„° ì•”í˜¸í™”

#### ì „ì†¡ ì¤‘
- HTTPS/TLS 1.3 ì‚¬ìš© (Nginx ì„¤ì • í•„ìš”)
- API í‚¤ëŠ” í™˜ê²½ ë³€ìˆ˜ë¡œ ê´€ë¦¬

#### ì €ì¥ ì‹œ
- PostgreSQL: ë¯¼ê° ì •ë³´ AES-256 ì•”í˜¸í™”
- Redis: ì„¸ì…˜ ë°ì´í„° ì•”í˜¸í™” ê³ ë ¤
- ChromaDB: ë²¡í„°ëŠ” í‰ë¬¸ (ë¯¼ê° ì •ë³´ ì•„ë‹˜)

---

## 6. ì„±ëŠ¥ ë° í™•ì¥ì„±

### 6.1 í˜„ì¬ ì„±ëŠ¥ íŠ¹ì„±

| ì‘ì—… | ì†Œìš” ì‹œê°„ | ì²˜ë¦¬ëŸ‰ |
|------|----------|--------|
| ë¬¸ì„œ ìƒì„± (Python í”„ë¡œì íŠ¸) | ~5ë¶„ | ~462ê°œ chunk/í”„ë¡œì íŠ¸ |
| RAG í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ | <1ì´ˆ | ~10K ë¬¸ì„œ |
| LLM í˜¸ì¶œ (ì¬ì‹œë„ í¬í•¨) | 2-5ì´ˆ | ë¶„ë‹¹ ~10íšŒ (OpenAI ì œí•œ) |
| ì„ë² ë”© ìƒì„± (ë°°ì¹˜) | ~3ì´ˆ/100ê°œ | ìºì‹œ íˆíŠ¸ìœ¨ 70%+ |

### 6.2 í™•ì¥ì„± ì„¤ê³„

#### ëª¨ë“ˆ ë‹¨ìœ„ ë¶„ë¦¬ (ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì „í™˜ ì¤€ë¹„)

```
í˜„ì¬: ëª¨ë†€ë¦¬ìŠ¤ (ë‹¨ì¼ ë ˆí¬, ë…ë¦½ ì„œë¹„ìŠ¤)
     â†“
í–¥í›„: ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤
     â”œâ”€ document-generator-service
     â”œâ”€ rag-engine-service
     â”œâ”€ llm-chat-service
     â””â”€ workflow-orchestrator-service
```

#### ìˆ˜í‰ í™•ì¥ ê°€ëŠ¥ ì„œë¹„ìŠ¤

| ì„œë¹„ìŠ¤ | ìˆ˜í‰ í™•ì¥ | ì¡°ê±´ |
|--------|----------|------|
| Document Generator | âœ… ê°€ëŠ¥ | ìƒíƒœ ë¹„ì €ì¥ |
| RAG Engine | âœ… ê°€ëŠ¥ | ì½ê¸° ì „ìš© (ë²¡í„° DB ê³µìœ ) |
| LLM Chat Service | âš ï¸ ì œí•œì  | ì„¸ì…˜ Redis ì´ê´€ í•„ìš” |
| Workflow Orchestrator | âœ… ê°€ëŠ¥ | ìƒíƒœ ë¹„ì €ì¥ |

#### ë³‘ëª© ì§€ì  ë° í•´ê²° ë°©ì•ˆ

```
ğŸ”´ ë³‘ëª©: ChromaDB ë‹¨ì¼ ì¸ìŠ¤í„´ìŠ¤
   í•´ê²°: Pinecone/Weaviate Cloud ì´ê´€

ğŸ”´ ë³‘ëª©: OpenAI API í˜¸ì¶œëŸ‰ ì œí•œ
   í•´ê²°: ìºì‹±, ë°°ì¹˜ ì²˜ë¦¬, ë©€í‹° í‚¤ ë¡œí…Œì´ì…˜

ğŸŸ¡ ë³‘ëª©: ì„¸ì…˜ ë©”ëª¨ë¦¬ ì €ì¥
   í•´ê²°: Redis ê¸°ë°˜ ì„¸ì…˜ ìŠ¤í† ì–´

ğŸŸ¢ ë³‘ëª©: PostgreSQL (í˜„ì¬ ì—†ìŒ)
   í–¥í›„: ì½ê¸° ë³µì œë³¸, ìƒ¤ë”©
```

### 6.3 ìºì‹± ì „ëµ

```
L1 (ë©”ëª¨ë¦¬): ì„ë² ë”© ìºì‹œ
  - ìœ„ì¹˜: RAG Engine ë‚´ë¶€
  - í¬ê¸°: ë¬´ì œí•œ (ë©”ëª¨ë¦¬ ì˜ì¡´)
  - íˆíŠ¸ìœ¨: ~70%

L2 (Redis): ê²€ìƒ‰ ê²°ê³¼ ìºì‹œ
  - ìœ„ì¹˜: Redis
  - TTL: 1ì‹œê°„
  - íˆíŠ¸ìœ¨: ë¯¸êµ¬í˜„ (í–¥í›„)

L3 (CDN): ì •ì  ë¬¸ì„œ ìºì‹œ
  - ìœ„ì¹˜: CDN (í”„ë¡ íŠ¸ì—”ë“œ)
  - ëŒ€ìƒ: generated_docs/*.md
  - ìƒíƒœ: ë¯¸êµ¬í˜„
```

### 6.4 ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™”

#### PostgreSQL

```sql
-- ì¸ë±ìŠ¤ ì „ëµ (í–¥í›„ êµ¬í˜„)
CREATE INDEX idx_sessions_user_id ON chat_sessions(user_id);
CREATE INDEX idx_messages_session_id ON chat_messages(session_id);
CREATE INDEX idx_documents_created_at ON documents(created_at);
```

#### ChromaDB

```python
# í˜„ì¬: ë¡œì»¬ í¼ì‹œìŠ¤í„´íŠ¸ (rag_storage/chroma_db)
# í–¥í›„: í´ë¼ìš°ë“œ ë²¡í„° DB
#   - Pinecone: ê³ ì„±ëŠ¥, ê´€ë¦¬í˜•
#   - Weaviate: ì˜¤í”ˆì†ŒìŠ¤, ìì²´ í˜¸ìŠ¤íŒ…
#   - Qdrant: ê³ ì†, í•„í„°ë§ ê°•ë ¥
```

---

## 7. ëª¨ë‹ˆí„°ë§ ë° ìš´ì˜

### 7.1 ë¡œê¹… ì‹œìŠ¤í…œ

#### ë¡œê·¸ íŒŒì¼ ìœ„ì¹˜

```
logs/
â”œâ”€â”€ docgen.log              # Document Generator
â”œâ”€â”€ rag.log                 # RAG Engine
â”œâ”€â”€ llm.log                 # LLM Chat Service
â”œâ”€â”€ workflow.log            # Workflow Orchestrator
â””â”€â”€ workflow_detailed.log   # Workflow ìƒì„¸ ë¡œê·¸
```

#### ë¡œê·¸ í¬ë§·

```
%(asctime)s - %(name)s - %(levelname)s - %(message)s

ì˜ˆì‹œ:
2025-10-13 10:30:45 - workflow - INFO - ğŸ” [a1b2c3] OpenAI API í˜¸ì¶œ ì‹œì‘
```

#### ë¡œê·¸ ë ˆë²¨

```python
DEBUG   # ìƒì„¸ ë””ë²„ê¹… ì •ë³´
INFO    # ì¼ë°˜ ì •ë³´ (ê¸°ë³¸)
WARNING # ê²½ê³ 
ERROR   # ì˜¤ë¥˜
CRITICAL # ì¹˜ëª…ì  ì˜¤ë¥˜
```

### 7.2 ë©”íŠ¸ë¦­ìŠ¤

#### LLM Chat Service

```python
GET /api/v1/stats

ì‘ë‹µ:
{
  "api_call_stats": {
    "total_calls": 150,
    "successful_calls": 145,
    "failed_calls": 5,
    "calls_per_minute": 3,
    "last_call_time": 1697184645.123
  }
}
```

#### RAG Engine

```python
GET /api/v1/cache/stats

ì‘ë‹µ:
{
  "cache_stats": {
    "cache_size": 1024,
    "cache_hits": 750,
    "cache_misses": 250,
    "hit_rate_percent": 75.0
  }
}
```

#### í—¬ìŠ¤ì²´í¬

```python
GET /health

ì‘ë‹µ:
{
  "status": "healthy",
  "service": "RAG Engine",
  "documents_count": 462,
  "embedding_cache": {
    "cache_size": 1024,
    "hit_rate_percent": 75.0
  }
}
```

### 7.3 ìš´ì˜ API

| ì—”ë“œí¬ì¸íŠ¸ | ë©”ì„œë“œ | ìš©ë„ |
|-----------|--------|------|
| `/health` | GET | ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸ |
| `/api/v1/stats` | GET | API í˜¸ì¶œ í†µê³„ (LLM) |
| `/api/v1/cache/stats` | GET | ìºì‹œ í†µê³„ (RAG) |
| `/api/v1/cache/clear` | POST | ìºì‹œ ì´ˆê¸°í™” (RAG) |
| `/api/v1/documents` | DELETE | ì „ì²´ ë¬¸ì„œ ì‚­ì œ (RAG) |
| `/api/v1/debug` | GET | ë””ë²„ê·¸ ì •ë³´ (LLM) |

### 7.4 ì•Œë¦¼ ì‹œìŠ¤í…œ (í–¥í›„ êµ¬í˜„)

```python
# Slack ì•Œë¦¼ ì˜ˆì‹œ
- OpenAI API 429 ì˜¤ë¥˜ ë°œìƒ ì‹œ
- ì„œë¹„ìŠ¤ ë‹¤ìš´ ê°ì§€ ì‹œ
- ìºì‹œ íˆíŠ¸ìœ¨ ì €í•˜ ì‹œ
- ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰ 80% ì´ˆê³¼ ì‹œ
```

---

## 8. ì•„í‚¤í…ì²˜ ê²°ì • ì‚¬í•­(ADR)

### ADR-001: ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ê¸°ë°˜ ì„¤ê³„

**ìƒíƒœ**: âœ… ìŠ¹ì¸ë¨  
**ë‚ ì§œ**: 2024-09  
**ê²°ì •ì**: ì•„í‚¤í…ì²˜íŒ€

#### ì»¨í…ìŠ¤íŠ¸
- ì´ˆê¸° ëª¨ë†€ë¦¬ìŠ¤ êµ¬ì¡°ì—ì„œ ì‹œì‘
- í–¥í›„ í™•ì¥ì„± ë° ë…ë¦½ ë°°í¬ í•„ìš”
- íŒ€ ê°„ ê°œë°œ ë³‘ë ¬í™”

#### ê²°ì •
- ëª¨ë“ˆ ë‹¨ìœ„ë¡œ ë¶„ë¦¬ëœ ì„œë¹„ìŠ¤ êµ¬ì¡° ì±„íƒ
- ê° ì„œë¹„ìŠ¤ëŠ” ë…ë¦½ í¬íŠ¸ë¡œ ì‹¤í–‰
- REST API ê¸°ë°˜ í†µì‹ 

#### ê·¼ê±°
- **ì¥ì **:
  - í–¥í›„ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì „í™˜ ìš©ì´
  - ì„œë¹„ìŠ¤ë³„ ë…ë¦½ ë°°í¬ ê°€ëŠ¥
  - ì¥ì•  ê²©ë¦¬
  - ê¸°ìˆ  ìŠ¤íƒ ë…ë¦½ì„±
- **ë‹¨ì **:
  - ì„œë¹„ìŠ¤ ê°„ í†µì‹  ì˜¤ë²„í—¤ë“œ
  - ë°°í¬ ë³µì¡ë„ ì¦ê°€
  - ë¶„ì‚° íŠ¸ëœì­ì…˜ ì²˜ë¦¬ ì–´ë ¤ì›€

#### ì˜í–¥
- ê°œë°œ ë³µì¡ë„ ì¦ê°€
- ìš´ì˜ ë³µì¡ë„ ì¦ê°€
- í™•ì¥ì„± í™•ë³´

---

### ADR-002: ChromaDB ë¡œì»¬ í¼ì‹œìŠ¤í„´íŠ¸ ëª¨ë“œ

**ìƒíƒœ**: âœ… ìŠ¹ì¸ë¨  
**ë‚ ì§œ**: 2024-09

#### ì»¨í…ìŠ¤íŠ¸
- ë²¡í„° DB ì„ íƒ í•„ìš”
- ì´ˆê¸°ì—ëŠ” ì†Œê·œëª¨ ë°ì´í„° (~10K ë¬¸ì„œ)
- ê°œë°œ í™˜ê²½ ë‹¨ìˆœí™” í•„ìš”

#### ê²°ì •
- ChromaDB ì„ë² ë””ë“œ ëª¨ë“œ ì‚¬ìš©
- ë³„ë„ ì»¨í…Œì´ë„ˆ ë¶ˆí•„ìš”
- ë¡œì»¬ ë””ë ‰í† ë¦¬ì— í¼ì‹œìŠ¤í„´íŠ¸ ì €ì¥

#### ê·¼ê±°
- **ì¥ì **:
  - ìš´ì˜ ë³µì¡ë„ ê°ì†Œ
  - ê°œë°œ í™˜ê²½ ë‹¨ìˆœí™”
  - ì¶©ë¶„í•œ ì„±ëŠ¥ (10K ë¬¸ì„œ ì´í•˜)
  - ë¬´ë£Œ
- **ë‹¨ì **:
  - ìˆ˜í‰ í™•ì¥ ë¶ˆê°€
  - ëŒ€ê·œëª¨ ë°ì´í„° ì²˜ë¦¬ ì œí•œ
  - ê³ ê¸‰ ê¸°ëŠ¥ ë¶€ì¡±

#### ì˜í–¥
- ì´ˆê¸° ê°œë°œ ì†ë„ í–¥ìƒ
- í–¥í›„ Pinecone/Weaviate ì´ê´€ ê³„íš

---

### ADR-003: RAG í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰

**ìƒíƒœ**: âœ… ìŠ¹ì¸ë¨  
**ë‚ ì§œ**: 2024-10

#### ì»¨í…ìŠ¤íŠ¸
- ìˆœìˆ˜ ë²¡í„° ê²€ìƒ‰ë§Œìœ¼ë¡œëŠ” í‚¤ì›Œë“œ ë§¤ì¹­ ì•½í•¨
- í•œêµ­ì–´ ê²€ìƒ‰ í’ˆì§ˆ í–¥ìƒ í•„ìš”
- íŠ¹ì • íŒŒì¼/í•¨ìˆ˜ ì°¾ê¸° ì–´ë ¤ì›€

#### ê²°ì •
- BM25 + ë²¡í„° ìœ ì‚¬ë„ + RRF ê²°í•©
- í´ë” ìš°ì„ ìˆœìœ„ ì¶”ê°€
- ì¬ë­í‚¹ ì‹œìŠ¤í…œ ë„ì…

#### ê·¼ê±°
- **ì¥ì **:
  - í‚¤ì›Œë“œ ê²€ìƒ‰ê³¼ ì˜ë¯¸ ê²€ìƒ‰ ì¥ì  ê²°í•©
  - í•œêµ­ì–´ ê²€ìƒ‰ í’ˆì§ˆ ëŒ€í­ í–¥ìƒ
  - ì •í™•ë„ ê°œì„  (ì¸¡ì • í•„ìš”)
- **ë‹¨ì **:
  - ë³µì¡ë„ ì¦ê°€
  - ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì¦ê°€ (BM25 ì¸ë±ìŠ¤)

#### ì˜í–¥
- ê²€ìƒ‰ í’ˆì§ˆ í–¥ìƒ
- ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì¦ê°€ (~10MB)

---

### ADR-004: Jinja2 í…œí”Œë¦¿ ê¸°ë°˜ ë¬¸ì„œ ìƒì„±

**ìƒíƒœ**: âœ… ìŠ¹ì¸ë¨  
**ë‚ ì§œ**: 2024-10

#### ì»¨í…ìŠ¤íŠ¸
- ê¸°ì¡´ ì½”ë“œ ê¸°ë°˜ ë¬¸ì„œ ìƒì„± ìœ ì§€ë³´ìˆ˜ ì–´ë ¤ì›€
- ë‹¤ì–‘í•œ ì–¸ì–´/í”„ë¡œì íŠ¸ ì§€ì› í•„ìš”
- í…œí”Œë¦¿ ìˆ˜ì • ì‹œ ì½”ë“œ ë³€ê²½ ë¶ˆí•„ìš”

#### ê²°ì •
- Jinja2 ê¸°ë°˜ ì™¸ë¶€ í…œí”Œë¦¿ íŒŒì¼ ì‚¬ìš©
- ì–¸ì–´ë³„ í…œí”Œë¦¿ ë¶„ë¦¬
- í´ë°± ì‹œìŠ¤í…œ êµ¬í˜„

#### ê·¼ê±°
- **ì¥ì **:
  - í…œí”Œë¦¿ ìˆ˜ì • ì‹œ ì½”ë“œ ë³€ê²½ ë¶ˆí•„ìš”
  - ë‹¤ì–‘í•œ ì–¸ì–´/í”„ë¡œì íŠ¸ ì§€ì› í™•ì¥ ìš©ì´
  - ë””ìì´ë„ˆ/ê¸°íšìë„ í…œí”Œë¦¿ ìˆ˜ì • ê°€ëŠ¥
  - í´ë°± ì‹œìŠ¤í…œìœ¼ë¡œ ì•ˆì •ì„± í™•ë³´
- **ë‹¨ì **:
  - í…œí”Œë¦¿ í•™ìŠµ ê³¡ì„ 
  - ë””ë²„ê¹… ì–´ë ¤ì›€

#### ì˜í–¥
- ìœ ì§€ë³´ìˆ˜ì„± í–¥ìƒ
- í™•ì¥ì„± í™•ë³´

---

## 9. ë§ˆì´ê·¸ë ˆì´ì…˜/ë°°í¬ ì „ëµ

### 9.1 í™˜ê²½ë³„ ì„¤ì •

```
config/
â”œâ”€â”€ development/    # ë¡œì»¬ ê°œë°œ í™˜ê²½
â”‚   â”œâ”€â”€ .env
â”‚   â””â”€â”€ docker-compose.dev.yml
â”‚
â”œâ”€â”€ staging/        # ìŠ¤í…Œì´ì§• í™˜ê²½
â”‚   â”œâ”€â”€ .env
â”‚   â””â”€â”€ docker-compose.staging.yml
â”‚
â””â”€â”€ production/     # í”„ë¡œë•ì…˜ í™˜ê²½
    â”œâ”€â”€ .env
    â””â”€â”€ docker-compose.prod.yml
```

### 9.2 ë°°í¬ ë‹¨ê³„

```bash
# 1. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
cp env.example .env
# .env íŒŒì¼ ìˆ˜ì •

# 2. Docker Compose ë¹Œë“œ
docker-compose build

# 3. ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜
docker-compose run --rm document-generator alembic upgrade head

# 4. ì„œë¹„ìŠ¤ ì‹œì‘
docker-compose up -d

# 5. í—¬ìŠ¤ì²´í¬ í™•ì¸
./scripts/setup/test_services.py

# 6. Nginx ì„¤ì • í™•ì¸
curl http://localhost/health
```

### 9.3 ë¡¤ë°± ì „ëµ

```bash
# ì„œë¹„ìŠ¤ë³„ ë¡¤ë°±
docker-compose up -d llm-chat:1.0.0  # ì´ì „ ë²„ì „ìœ¼ë¡œ

# ë°ì´í„°ë² ì´ìŠ¤ ë¡¤ë°±
docker-compose run --rm document-generator alembic downgrade -1

# ì „ì²´ ë¡¤ë°±
docker-compose down
docker-compose -f docker-compose.backup.yml up -d
```

### 9.4 ë¸”ë£¨-ê·¸ë¦° ë°°í¬ (í–¥í›„)

```
ë¸”ë£¨(í˜„ì¬ ë²„ì „)          ê·¸ë¦°(ìƒˆ ë²„ì „)
     â†“                      â†“
   ì„œë¹„ìŠ¤ë“¤              ì„œë¹„ìŠ¤ë“¤
     â†“                      â†“
   ë¡œë“œë°¸ëŸ°ì„œ â† íŠ¸ë˜í”½ ì „í™˜
```

### 9.5 CI/CD íŒŒì´í”„ë¼ì¸ (í–¥í›„ êµ¬í˜„)

```yaml
# .github/workflows/deploy.yml

name: Deploy
on:
  push:
    branches: [main]

jobs:
  test:
    - pytest
    - black --check
    - flake8
    - mypy
    
  build:
    - docker build
    - docker push
    
  deploy:
    - ssh production
    - docker-compose pull
    - docker-compose up -d
    - health check
```

---

## 10. ê°œì„  ê¶Œê³ ì‚¬í•­ (ìš°ì„ ìˆœìœ„ë³„)

### ğŸ”´ High Priority (ì¦‰ì‹œ ì¡°ì¹˜ í•„ìš”)

#### 1. API í‚¤ í•˜ë“œì½”ë”© ì œê±°
**ìœ„ì¹˜**: `src/llm_chat_service/app.py:43, 399`

```python
# âŒ í˜„ì¬
correct_api_key = "sk-proj-rtIOr0IHt3Z4CUHy..."

# âœ… ê°œì„ 
import os
openai.api_key = os.getenv("OPENAI_API_KEY")
```

**ì‘ì—…ëŸ‰**: 1ì‹œê°„  
**ë¦¬ìŠ¤í¬**: ë†’ìŒ (ë³´ì•ˆ)

---

#### 2. CORS ì„¤ì • ê°•í™”
**ìœ„ì¹˜**: ëª¨ë“  ì„œë¹„ìŠ¤ `app.py`

```python
# âŒ í˜„ì¬
allow_origins=["*"]

# âœ… ê°œì„ 
allow_origins=os.getenv("ALLOWED_ORIGINS", "").split(",")
```

**ì‘ì—…ëŸ‰**: 2ì‹œê°„  
**ë¦¬ìŠ¤í¬**: ì¤‘ê°„

---

#### 3. Rate Limiting ì¶”ê°€
**ëŒ€ìƒ**: ëª¨ë“  ì™¸ë¶€ API ì—”ë“œí¬ì¸íŠ¸

```python
from slowapi import Limiter

limiter = Limiter(key_func=get_remote_address)

@app.post("/api/v1/chat/sessions/{session_id}/messages")
@limiter.limit("10/minute")
async def send_message(...):
    ...
```

**ì‘ì—…ëŸ‰**: 4ì‹œê°„  
**ë¦¬ìŠ¤í¬**: ì¤‘ê°„

---

#### 4. ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸
**í˜„ì¬ ìƒíƒœ**: Alembic ì„¤ì •ë§Œ ìˆìŒ, ì‹¤ì œ ë§ˆì´ê·¸ë ˆì´ì…˜ ì—†ìŒ

```bash
# í•„ìš” ì‘ì—…
alembic init migrations
alembic revision --autogenerate -m "initial"
alembic upgrade head
```

**ì‘ì—…ëŸ‰**: 8ì‹œê°„  
**ë¦¬ìŠ¤í¬**: ë†’ìŒ

---

### ğŸŸ¡ Medium Priority (1ê°œì›” ë‚´)

#### 1. ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ êµ¬ì¶•
**ë„êµ¬**: Prometheus + Grafana

```yaml
# docker-composeì— ì¶”ê°€
prometheus:
  image: prom/prometheus
  
grafana:
  image: grafana/grafana
```

**ì‘ì—…ëŸ‰**: 3ì¼  
**ë¦¬ìŠ¤í¬**: ë‚®ìŒ

---

#### 2. CI/CD íŒŒì´í”„ë¼ì¸
**ë„êµ¬**: GitHub Actions

```yaml
# .github/workflows/ci.yml
- í…ŒìŠ¤íŠ¸ ìë™í™”
- ë¦°íŠ¸ ê²€ì‚¬
- Docker ë¹Œë“œ
- ìë™ ë°°í¬
```

**ì‘ì—…ëŸ‰**: 5ì¼  
**ë¦¬ìŠ¤í¬**: ì¤‘ê°„

---

#### 3. E2E í…ŒìŠ¤íŠ¸ ì‘ì„±
**í˜„ì¬ ìƒíƒœ**: í…ŒìŠ¤íŠ¸ ë””ë ‰í† ë¦¬ ë¹„ì–´ìˆìŒ

```
tests/
â”œâ”€â”€ unit/
â”‚   â”œâ”€â”€ test_document_generator.py
â”‚   â”œâ”€â”€ test_rag_engine.py
â”‚   â””â”€â”€ test_llm_chat.py
â”œâ”€â”€ integration/
â”‚   â””â”€â”€ test_workflow.py
â””â”€â”€ e2e/
    â””â”€â”€ test_full_workflow.py
```

**ì‘ì—…ëŸ‰**: 2ì£¼  
**ë¦¬ìŠ¤í¬**: ë‚®ìŒ

---

#### 4. ì„¸ì…˜ ìŠ¤í† ì–´ Redis ì´ê´€
**í˜„ì¬**: ë©”ëª¨ë¦¬ ê¸°ë°˜ (ì¬ì‹œì‘ ì‹œ ì†ì‹¤)

```python
# í˜„ì¬
sessions = {}  # ë©”ëª¨ë¦¬

# ê°œì„ 
import redis
redis_client = redis.Redis(...)
```

**ì‘ì—…ëŸ‰**: 1ì£¼  
**ë¦¬ìŠ¤í¬**: ì¤‘ê°„

---

### ğŸŸ¢ Low Priority (3ê°œì›” ë‚´)

#### 1. í´ë¼ìš°ë“œ ë²¡í„° DB ì´ê´€
**í˜„ì¬**: ChromaDB ë¡œì»¬  
**ëª©í‘œ**: Pinecone/Weaviate

**ì‘ì—…ëŸ‰**: 2ì£¼  
**ë¦¬ìŠ¤í¬**: ë†’ìŒ

---

#### 2. í”„ë¡ íŠ¸ì—”ë“œ í†µí•©
**í˜„ì¬**: ë°±ì—”ë“œë§Œ êµ¬í˜„  
**ëª©í‘œ**: Vue 3 ê¸°ë°˜ ì›¹ UI

**ì‘ì—…ëŸ‰**: 1ê°œì›”  
**ë¦¬ìŠ¤í¬**: ì¤‘ê°„

---

#### 3. ë‹¤êµ­ì–´ ì§€ì›
**í˜„ì¬**: í•œêµ­ì–´ ì¤‘ì‹¬  
**ëª©í‘œ**: ì˜ì–´, ì¼ë³¸ì–´ ë“±

**ì‘ì—…ëŸ‰**: 2ì£¼  
**ë¦¬ìŠ¤í¬**: ë‚®ìŒ

---

#### 4. í”ŒëŸ¬ê·¸ì¸ ì‹œìŠ¤í…œ
**ëª©í‘œ**: ì»¤ìŠ¤í…€ ë¶„ì„ê¸° ì¶”ê°€ ê°€ëŠ¥

**ì‘ì—…ëŸ‰**: 1ê°œì›”  
**ë¦¬ìŠ¤í¬**: ì¤‘ê°„

---

## 11. ê¸°ìˆ  ë¶€ì±„ ë° ì œì•½ì‚¬í•­

### 11.1 í˜„ì¬ ì•Œë ¤ì§„ ì œì•½

#### ì„¸ì…˜ ì €ì¥ì†Œ
```
ë¬¸ì œ: ë©”ëª¨ë¦¬ ê¸°ë°˜ ì„¸ì…˜ ì €ì¥
ì˜í–¥: ì„œë¹„ìŠ¤ ì¬ì‹œì‘ ì‹œ ëª¨ë“  ì„¸ì…˜ ì†ì‹¤
í•´ê²°: Redis ê¸°ë°˜ ì„¸ì…˜ ìŠ¤í† ì–´ ì´ê´€
ìš°ì„ ìˆœìœ„: ğŸŸ¡ Medium
```

#### ë²¡í„° DB
```
ë¬¸ì œ: ChromaDB ë‹¨ì¼ ì¸ìŠ¤í„´ìŠ¤
ì˜í–¥: ìˆ˜í‰ í™•ì¥ ë¶ˆê°€, 10K ë¬¸ì„œ ì œí•œ
í•´ê²°: Pinecone/Weaviate ì´ê´€
ìš°ì„ ìˆœìœ„: ğŸŸ¢ Low (í˜„ì¬ ë¬¸ì œ ì—†ìŒ)
```

#### LLM ì˜ì¡´ì„±
```
ë¬¸ì œ: OpenAI API ë‹¤ìš´ ì‹œ ì „ì²´ ì„œë¹„ìŠ¤ ì˜í–¥
ì˜í–¥: ì„œë¹„ìŠ¤ ë¶ˆê°€
í•´ê²°: ë©€í‹° LLM ì œê³µì—…ì²´ ì§€ì› (Anthropic)
ìš°ì„ ìˆœìœ„: ğŸŸ¡ Medium
```

#### í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€
```
ë¬¸ì œ: ë‹¨ìœ„/í†µí•© í…ŒìŠ¤íŠ¸ ë¯¸êµ¬í˜„
ì˜í–¥: ë¦¬íŒ©í† ë§ ì‹œ íšŒê·€ ë²„ê·¸ ìœ„í—˜
í•´ê²°: pytest ê¸°ë°˜ í…ŒìŠ¤íŠ¸ ì‘ì„±
ìš°ì„ ìˆœìœ„: ğŸŸ¡ Medium
```

---

### 11.2 ê¸°ìˆ  ë¶€ì±„ ëª©ë¡

| ë¶€ì±„ | ìœ„ì¹˜ | ì˜í–¥ë„ | ìš°ì„ ìˆœìœ„ |
|------|------|--------|---------|
| API í‚¤ í•˜ë“œì½”ë”© | llm_chat_service/app.py | ğŸ”´ High | ğŸ”´ ì¦‰ì‹œ |
| CORS ì„¤ì • ë¯¸ì™„ | ëª¨ë“  ì„œë¹„ìŠ¤ | ğŸŸ¡ Medium | ğŸ”´ ì¦‰ì‹œ |
| ì—ëŸ¬ ì²˜ë¦¬ í‘œì¤€í™” ë¶€ì¡± | ëª¨ë“  ì„œë¹„ìŠ¤ | ğŸŸ¡ Medium | ğŸŸ¡ 1ê°œì›” |
| ë¡œê¹… í¬ë§· ì¼ê´€ì„± ë¶€ì¡± | ëª¨ë“  ì„œë¹„ìŠ¤ | ğŸŸ¢ Low | ğŸŸ¢ 3ê°œì›” |
| ë©”ëª¨ë¦¬ ì„¸ì…˜ ì €ì¥ | llm_chat_service | ğŸŸ¡ Medium | ğŸŸ¡ 1ê°œì›” |
| í…ŒìŠ¤íŠ¸ ë¯¸êµ¬í˜„ | tests/ | ğŸŸ¡ Medium | ğŸŸ¡ 1ê°œì›” |
| ë¬¸ì„œí™” ë¶€ì¡± | docs/ | ğŸŸ¢ Low | ğŸŸ¢ 3ê°œì›” |
| ì„±ëŠ¥ í”„ë¡œíŒŒì¼ë§ ë¯¸ì‹¤ì‹œ | ì „ì²´ | ğŸŸ¢ Low | ğŸŸ¢ 3ê°œì›” |

---

### 11.3 ì œì•½ì‚¬í•­ ë° ì „ì œì¡°ê±´

#### OpenAI API ì œí•œ
```
Rate Limit: ë¶„ë‹¹ 60íšŒ (Tier 1)
RPD (Requests Per Day): 200íšŒ
TPM (Tokens Per Minute): 90K

ëŒ€ì‘:
- ìºì‹±ìœ¼ë¡œ í˜¸ì¶œ ìˆ˜ ê°ì†Œ
- ë°°ì¹˜ ì²˜ë¦¬
- ì¬ì‹œë„ ë¡œì§
- í–¥í›„: ë©€í‹° í‚¤ ë¡œí…Œì´ì…˜
```

#### ì„ë² ë”© ì°¨ì›
```
ëª¨ë¸: text-embedding-3-small
ì°¨ì›: 1536
í¬ê¸°: ~6KB per embedding

ì˜í–¥:
- ChromaDB ì €ì¥ ìš©ëŸ‰
- ê²€ìƒ‰ ì†ë„
- ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰

10K ë¬¸ì„œ ê¸°ì¤€:
- ì„ë² ë”© í¬ê¸°: ~60MB
- ë©”ëª¨ë¦¬: ~100MB
- ë””ìŠ¤í¬: ~200MB
```

#### PostgreSQL ì—°ê²° ìˆ˜
```
ê¸°ë³¸: 100 ë™ì‹œ ì—°ê²°
ê¶Œì¥: 20-30 ì—°ê²° (ì„œë¹„ìŠ¤ë‹¹)

ëª¨ë‹ˆí„°ë§ í•„ìš”:
SELECT count(*) FROM pg_stat_activity;
```

---

## 12. ì°¸ê³  ë¬¸ì„œ

### 12.1 ë‚´ë¶€ ë¬¸ì„œ

| ë¬¸ì„œ | ìœ„ì¹˜ | ì„¤ëª… |
|------|------|------|
| ì„¤ê³„ ë¬¸ì„œ | `CodeMuse_Design_Document.md` | ì „ì²´ ì‹œìŠ¤í…œ ì„¤ê³„ |
| ì €ì¥ì†Œ êµ¬ì¡° | `REPOSITORY_STRUCTURE.md` | ë ˆí¬ êµ¬ì¡° ì„¤ëª… |
| README | `README.md` | ë¹ ë¥¸ ì‹œì‘ ê°€ì´ë“œ |
| API ì—”ë“œí¬ì¸íŠ¸ | `FRONTEND_API_ENDPOINTS.md` | í”„ë¡ íŠ¸ì—”ë“œ ì—°ë™ ê°€ì´ë“œ |
| ì„±ëŠ¥ ìµœì í™” | `RAG_PERFORMANCE_OPTIMIZATION.md` | RAG ìµœì í™” ê°€ì´ë“œ |

### 12.2 ì™¸ë¶€ ë¬¸ì„œ

| ë¬¸ì„œ | URL | ì„¤ëª… |
|------|-----|------|
| FastAPI | https://fastapi.tiangolo.com | ì›¹ í”„ë ˆì„ì›Œí¬ |
| ChromaDB | https://docs.trychroma.com | ë²¡í„° DB |
| OpenAI API | https://platform.openai.com/docs | LLM API |
| Docker Compose | https://docs.docker.com/compose | ì»¨í…Œì´ë„ˆ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ |
| Jinja2 | https://jinja.palletsprojects.com | í…œí”Œë¦¿ ì—”ì§„ |

### 12.3 API ë¬¸ì„œ (Swagger UI)

ì„œë¹„ìŠ¤ ì‹¤í–‰ í›„ ì•„ë˜ URLì—ì„œ í™•ì¸ ê°€ëŠ¥:

```
Document Generator:
http://localhost:8001/docs

RAG Engine:
http://localhost:8003/docs

LLM Chat Service:
http://localhost:8004/docs

Workflow Orchestrator:
http://localhost:8006/docs
```

---

## 13. ì—°ë½ì²˜ ë° ì§€ì›

### 13.1 ë‹´ë‹¹ì

| ì—­í•  | ë‹´ë‹¹ì | ì´ë©”ì¼ |
|------|-------|--------|
| í”„ë¡œì íŠ¸ ë¦¬ë“œ | - | - |
| ë°±ì—”ë“œ ê°œë°œ | - | - |
| ì¸í”„ë¼/DevOps | - | - |
| í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ | - | - |

### 13.2 ì´ìŠˆ ë¦¬í¬íŒ…

```
ë²„ê·¸ ë¦¬í¬íŠ¸: GitHub Issues
ê¸°ëŠ¥ ì œì•ˆ: GitHub Discussions
ë³´ì•ˆ ì´ìŠˆ: security@yourdomain.com
```

---

## ë¶€ë¡ A: ìš©ì–´ ì •ì˜

| ìš©ì–´ | ì •ì˜ |
|------|------|
| AST | Abstract Syntax Tree, ì¶”ìƒ êµ¬ë¬¸ íŠ¸ë¦¬ |
| RAG | Retrieval-Augmented Generation, ê²€ìƒ‰ ì¦ê°• ìƒì„± |
| BM25 | Best Matching 25, í‚¤ì›Œë“œ ê²€ìƒ‰ ì•Œê³ ë¦¬ì¦˜ |
| RRF | Reciprocal Rank Fusion, ìˆœìœ„ ìœµí•© ì•Œê³ ë¦¬ì¦˜ |
| SSE | Server-Sent Events, ì„œë²„ í‘¸ì‹œ ì´ë²¤íŠ¸ |
| LLM | Large Language Model, ëŒ€ê·œëª¨ ì–¸ì–´ ëª¨ë¸ |
| Chunk | ì˜ë¯¸ì ìœ¼ë¡œ ë¶„í• ëœ ì½”ë“œ ë‹¨ìœ„ |
| Embedding | í…ìŠ¤íŠ¸ë¥¼ ë²¡í„°ë¡œ ë³€í™˜í•œ ê²ƒ |
| Hybrid Search | í‚¤ì›Œë“œ + ë²¡í„° ê²€ìƒ‰ ê²°í•© |

---

## ë¶€ë¡ B: í¬íŠ¸ ë§¤í•‘

| ì„œë¹„ìŠ¤ | í¬íŠ¸ | í”„ë¡œí† ì½œ | ìš©ë„ |
|--------|------|---------|------|
| Document Generator | 8001 | HTTP | ë¬¸ì„œ ìƒì„± API |
| RAG Engine | 8003 | HTTP | ê²€ìƒ‰ API |
| LLM Chat Service | 8004 | HTTP/SSE | ì±„íŒ… API |
| Workflow Orchestrator | 8006 | HTTP/SSE | ì›Œí¬í”Œë¡œìš° API |
| PostgreSQL | 5432 | TCP | ë°ì´í„°ë² ì´ìŠ¤ |
| Redis | 6379 | TCP | ìºì‹œ |
| Nginx | 80/443 | HTTP/HTTPS | ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ |

---

## ë¶€ë¡ C: í™˜ê²½ ë³€ìˆ˜ ì „ì²´ ëª©ë¡

```bash
# ë°ì´í„°ë² ì´ìŠ¤
DATABASE_URL=postgresql://user:pass@host:5432/db
REDIS_URL=redis://host:6379

# LLM API
OPENAI_API_KEY=sk-proj-...
ANTHROPIC_API_KEY=sk-ant-...

# ì„œë¹„ìŠ¤ URL (Docker Compose ë‚´ë¶€)
LLM_SERVICE_URL=http://llm-chat:8004
RAG_SERVICE_URL=http://rag-engine:8003

# ë³´ì•ˆ
SECRET_KEY=your-secret-key
ALLOWED_ORIGINS=https://yourdomain.com

# RAG ì„¤ì •
RAG_RESET_ON_START=false
EMBEDDING_CACHE_ENABLED=true
CHUNK_CONTEXT_CHAR_LIMIT=800
LLM_CONTEXT_MAX_CHARS=3000

# ë¡œê¹…
LOG_LEVEL=INFO
```

---

**ë¬¸ì„œ ë²„ì „**: 1.0  
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-10-13  
**ì‘ì„±ì**: CodeMuse ê°œë°œíŒ€  
**ê²€í† ì**: ì•„í‚¤í…ì²˜íŒ€

