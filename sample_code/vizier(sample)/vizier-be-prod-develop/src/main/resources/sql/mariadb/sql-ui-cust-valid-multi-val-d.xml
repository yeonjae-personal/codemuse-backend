<?xml version="1.0" encoding="UTF-8"?>
<!--
  ~ Copyright (c) 2023. Lorem ipsum dolor sit amet, consectetur adipiscing elit.
  ~ Morbi non lorem porttitor neque feugiat blandit. Ut vitae ipsum eget quam lacinia accumsan.
  ~ Etiam sed turpis ac ipsum condimentum fringilla. Maecenas magna.
  ~ Proin dapibus sapien vel ante. Aliquam erat volutpat. Pellentesque sagittis ligula eget metus.
  ~ Vestibulum commodo. Ut rhoncus gravida arcu.
  -->

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ui-cust-valid-multi-val-d">
	
	<insert id ="insert">
		INSERT INTO tb_cust_valid_multi_val_d
			(valid_code, attr_uuid, attr_seq, attr_val, rgst_user, rgst_dtm, upd_user, upd_dtm)
		VALUES (#{validCode}, #{attrUuid}, #{attrSeq}, #{attrVal}, #{rgstUser}, now(), #{updUser}, now())
	</insert>
	
	<delete id="delete">
        DELETE
        FROM tb_cust_valid_multi_val_d
        WHERE valid_code = #{validCode} and attr_uuid = #{attrUuid}
    </delete>
    
    <select id="findAttrSeq" resultType="int">
		SELECT t.attr_seq
        FROM tb_cust_valid_multi_val_d t where t.valid_code = #{validCode} and t.attr_uuid = #{attrUuid}
        order by t.attr_seq DESC
	</select>
	
	<select id="find" resultType="string">
		SELECT t.attr_val
        FROM tb_cust_valid_multi_val_d t where t.valid_code = #{validCode} and t.attr_uuid = #{attrUuid}
	</select>
	
	<select id="findMultiplaAttr" resultType="com.lgcns.svcp.prod.ui.prod.dto.customvalidation.MultipleAttrDto">
		select t2.comm_group_code, t1.attr_val from tb_cust_valid_multi_val_d t1 
		inner join tb_add_attr_header_m t2 on t1.attr_uuid = t2.attr_uuid 
		where t1.attr_uuid = #{attrUuid} and t1.valid_code = #{validCode}
	</select>
	
</mapper>